<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name=viewport content="width=device-width, initial-scale=1">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.5/ace.js"></script>
    <title>koDi</title>
    <link rel="stylesheet" href="normalize.css">
    <link rel="stylesheet" href="stylesheet.css">
    <script src="//localhost:35729/livereload.js"></script>
    <script src="js/jquery.hypher.js"></script>
    <script src="js/en-gb.js"></script>

    <!-- you don't need to keep this, but it's cool for stats! -->
    <meta name="generator" content="Nanoc 4.3.3">
  </head>
  <body>
      
<header>
  <div class="title">ko<span class="d">D</span>i</div>
  <div class="subtitle">kommutative Diagramme f√ºr
    *<span class="tex">T<sub>e</sub>X</span>*
  </div>
</header>


<div id="display"></div>

<button id="compile">Compile!</button>

<div id="editor">\begin{kodi}

\lay[comb]{
  |(P)| A \times_Z B & B \\
        A            & Z \\
};

\obj at=($(Z)!2!(P)$), "Q";

\mor[swap] P p_1:-> A f:-> Z;
\mor       * P_2:-> B g:-> *;
\mor[swap] Q q_1:l> A;
\mor       * q_2:r> B;
\mor[mid:dashed] * u:-> P;

\end{kodi}</div>

<script type="text/javascript">

$('p').hyphenate('en-gb');

var editor = ace.edit("editor");
editor.setTheme("ace/theme/chrome");
editor.getSession().setMode("ace/mode/latex");
editor.setOptions({
  fontSize: 20,
  maxLines: 20,
  minLines: 5
});

$('#compile').click(function() {

  $('#display').html("Compiling..");

  var longWaitTimerId = setTimeout(function () {
    $('#display').html("Server asleep. Waking up the poor thing.");
  }, 1500);

  $.ajax({
    method: 'POST',
    url: 'https://texrhobot.herokuapp.com/svg',
    // url: 'http://0.0.0.0:5000/svg',
    data: {
      "document": editor.getValue()
    }
  }).done(function(data) {
    clearTimeout(longWaitTimerId);
    var svg = $(data).find("svg");
    var exHeight = parseFloat(svg.attr('height'))/parseFloat("4.30554pt")+"ex";
    var exWidth = parseFloat(svg.attr('width'))/parseFloat("4.30554pt")+"ex";
    svg.attr('height', exHeight);
    svg.attr('width', exWidth);
    $('#display').html(svg);
  }).fail(function(err) {
    console.log( err );
  });


});

</script>

  </body>
</html>
